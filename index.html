<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Trivia Application</title>
    <link rel="stylesheet" href="style/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
</head>
<body>
    <main>
        <div class="main-pane">
            
            <div class="mid">
     
            </div>

        </div>

        <aside class="side-pane">
            <div class="bot">
                <button title="Delete User Name">
                    <span class="material-icons appear">
                    delete
                    </span>
                </button>
            </div>
            <div class="top">
                
                <h2>Enter User Name</h2>
                <h3>100</h3>
            </div>
            <div class="bottom">
                <div class="participant-info">
                    <img src="assets/bg1.png" width="200" height="200" alt="" class="participant-image">
                    <div class="info">
                        <h1 class="participant-name">Apple Ball</h1>
                        <h2 class="participant-score">1234</h2>
                    </div>
                </div>
                <div class="participant-info">
                    <img src="assets/bg1.png" width="200" height="200" alt="" class="participant-image">
                    <div class="info">
                        <h1 class="participant-name">Apple Ball</h1>
                        <h1 class="participant-score">1234</h1>
                    </div>
                </div>
                <div class="participant-info">
                    <img src="assets/bg1.png" width="200" height="200" alt="" class="participant-image">
                    <div class="info">
                        <h1 class="participant-name">Apple Ball</h1>
                        <h1 class="participant-score">1234</h1>
                    </div>
                </div>
                <div class="participant-info">
                    <img src="assets/bg1.png" width="200" height="200" alt="" class="participant-image">
                    <div class="info">
                        <h1 class="participant-name">Apple Ball</h1>
                        <h1 class="participant-score">1234</h1>
                    </div>
                </div>
                <div class="participant-info">
                    <img src="assets/bg1.png" width="200" height="200" alt="" class="participant-image">
                    <div class="info">
                        <h1 class="participant-name">Apple Ball</h1>
                        <h1 class="participant-score">1234</h1>
                    </div>
                </div>
            </div>
        </aside>

        <template id="trivia">
            <section class="question-no">
                <h1>Question 1</h1>
            </section>
            <section class="question">
                <h1>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Eum quod culpa dignissimos optio sunt a, architecto, iure blanditiis ullam delectus nihil quas?</h1>
            </section>
            <div class="answers">
                <p class="answer" onclick="answer(event)" id="ans1">
                    Lorem, ipsum.
                </p>
                <p class="answer" onclick="answer(event)" id="ans2">
                    Lorem, ipsum.
                </p>
                <p class="answer" onclick="answer(event)" id="ans3">
                    Lorem, ipsum.
                </p>
                <p class="answer" onclick="answer(event)" id="ans4">
                    Lorem, ipsum.
                </p>
            </div>
            <div class="next">
                <button id="qnext">NEXT</button>
            </div>
        </template>

        <template id="formmer">
            <form id="name_form">
                <label for="name">UserName</label>
                <input type="text" id="name" required value="">
                <button type="submit">
                    <span class="material-icons">
                        save
                    </span>
                    <!-- save -->
                </button>
            </form>
        </template>
    </main>

    <script>
        window.onload = function(){
            var mid = document.querySelector(".mid")
            var nam = document.querySelector(".top > h2")

            var form = document.querySelector("#formmer")
            var fclone = document.importNode(form.content, true)

            var trivia = document.querySelector('#trivia');
            var clone = document.importNode(trivia.content, true)

            mid.appendChild(clone)

            var next = document.querySelector("#qnext")

            // temporary next question and answer, animation logic
            next.addEventListener('click', () => {
                // alert("adjis")
                document.querySelector(".question").classList.toggle("outy")
                document.querySelector(".answers").classList.toggle("flippy")
                if(document.querySelector(".answers > .set") != null){
                    document.querySelector(".answers > .set").classList.remove("set")
                }
                setTimeout(()=> {
                    document.querySelector(".question").classList.remove("outy")
                    document.querySelector(".question").classList.toggle("inny")
                    setTimeout(()=> {
                        document.querySelector(".question").classList.remove("inny")
                        document.querySelector(".answers").classList.remove("flippy")
                    }, 850)
                }, 600)

            })

            // display username if exist else fill the form that will be removed after the username is entered
            if(localStorage.getItem('User Name') != null){
                document.querySelector(".top > h2").innerText = localStorage.getItem('User Name')
            } else{
                nam.parentNode.prepend(fclone)
                form_submit()
            }

            // delete the username
            document.querySelector(".bot > button").addEventListener("click", e => {
                if(localStorage.getItem('User Name') != null){
                    var formt = document.querySelector("#formmer")
                    var fclonet = document.importNode(formt.content, true)
                    fclonet.querySelector("#name_form").classList.add("inny2")
                    nam.parentNode.prepend(fclonet)
                    localStorage.removeItem("User Name")
                    nam.innerText = "Enter User Name"
                    form_submit()
                }
            })
        }

        function answer(e){
            // debugger
            if(document.querySelector(".answers > .set") != null){
                document.querySelector(".answers > .set").classList.remove("set")
                if(document.querySelector(".answers > .set") != e.target){
                    e.target.classList.add("set")
                }
            } else{
                e.target.classList.add("set")
            }
            
        }

        // function to help with repetitive code
        function form_submit(){
            var dom_from = document.querySelector(".top > form")
            
            dom_from.addEventListener("submit", e => {
                dom_from.classList.remove("inny2")
                e.preventDefault();
                dom_from.classList.add("outy")
                var name = dom_from.querySelector("#name").value
                localStorage.setItem("User Name",name)
                document.querySelector(".top > h2").innerText = localStorage.getItem('User Name')
                setTimeout(() => {
                    dom_from.classList.remove("outy")
                    dom_from.remove()
                }, 400)
            })
        }

    </script>
</body>
</html>